# Linux基础

## 什么是Linux？

 Linux 就是一套操作系统。

Linux系统有狭义和广义两种定义。狭义来说，Linux实际上指Linux 内核（kernel）。广义来说，Linux是指以内核为基础的，包括了各种应 用软件在内的Linux发行版（Distribution）。

### 诞生的历史

1. 1973 年：Unix 的正式诞生，Ritchie 等人以 C 语言写出第一个正式 Unix 核心
   * Unix的移植特性来源于C语言的高级语言特性

2. 1984 年之一：x86 架构的 Minix 操作系统开始撰写并于两年后诞生
3. 1984 年之二：GNU 计划与 FSF 基—金会的成
   * 自由软件环境的诞生
   * 1984 年，史托曼开始 GNU 计划，这个计划的目的是：建立一个自由、开放的 Unix 操作系统(Free  Unix)
4. 1988 年：图形接口 XFree86 计划
5. 1991 年：芬兰大学生 Linus Torvalds 的一则简讯——Linux的雏形诞生。
   * Linux的后期完善是通过开源的环境，由广大的黑客完善驱动和软件，逐渐形成的

###  Linux distributions

Linux 是一个操作系统最底层的核心及其提供的核心工具。

为了让所有的 Linux distributions 开发不致于差异太大，且让开发商在开发的时候有所依 据，还有 Linux Standard Base (LSB)等标准来规范开发者，以及目录架构的 File system Hierarchy  Standard (FHS)标准规范。

distributions 主要分为两大系统，一种是使用 RPM 方式安装软件的系统，包括 Red Hat,  Fedora, SuSE 等都是这类； 一种则是使用 Debian 的 dpkg 方式安装软件的系统，包括 Debian, Ubuntu,  B2D 等等。

### Linux的应用场景

1. 网络服务器： 这是 Linux 当前最热门的应用。承袭了 Unix 高稳定性的良好传统，Linux 上面的网络功能特别的稳 定与强大；
2. 关键任务的应用(金融数据库、大型企业网管环境)；
3. 学术机构的高效能运算任务
4. 个人主机：主要就是手机、嵌入式系统
5. 云程序：底层用的是Linux架构的服务器

### Linux 的学习路线

1. 安装与指令
2. 基础技能
3. vim文书编辑器
4. Shell/Shell Script学习
5. 软件管理员
6. 网络基础、网站架设

在实战中学习是最有效的方法

## Linux的用户

- root是管理员账号。在命令行中使用 `$ su -`命令就可以切换到管理员账号。

# 主机规划和磁盘划分

## Linux的硬件

结论：根据需求选择，Linux对硬件的要求很低，小环境下要求更低。

在 Linux 系统中，每个装置都被当成一个文件来对待。这也代表了每个硬件装置会被当做一个文件来对待。

硬件装置文件都在/dev的目录内，

硬盘：/dev/sd[a-d]，一般硬盘的第一个扇区会记录整颗磁盘的重要信息——分区的信息会记录在每个分区槽最前面的几个扇区（这几个扇区无法被格式化）。

**为什么要分区？**

1. 数据的安全性
2. 系统的效能考虑

- 主要分区和逻辑分区：主要分区是借助分区表进行的第一次磁盘分区；逻辑分区是在最后一个分区上进行再次分区。

- 挂载：目录和磁盘挂钩，某个目录下的文件将会全部储存在一个磁盘中。

**开机流程中的BIOS和UFEI开机检测程序 **

BIOS是写入主板的韧体，是计算机会执行的“第一个”程序。

UEFI是C语言编写的更加容易开发的BIOS，也因此支持多平台，有图形化能力。

## 目录树

`/`是根目录，`挂载`就是利用一个目录当成进入点，将磁盘分区槽的数据放置在该目录下。

`~`是home目录，`cd ~`可以直接回到home目录。

文件和文件组织构成了一个文件系统（File System）。Linux的文 件系统是一个树状结构，整个文件系统有个共同的起点，就是树状结构 的顶端，如图15-1所示。Linux把这个起点称为根目录（Root Directory），用符号/表示。

目录本身也是一种 特殊的文件，而/home/pi/doc是指向目录文件doc的绝对路径。

当目录文件中增加一个文件的条目时，就建立一个指向文件的硬链 接（Hard Link）。一旦有了对应于文件的硬链接，这个文件就纳入了文 件系统中。一个文件允许出现在多个目录中，这样，它就有多个硬链接。文件拥有的硬链接数目，称为文件在整个系统的链接数（Link Count）。当文件的链接数降为0时，说明文件已经孤立于文件系统之 外。这样的文件会被Linux删除。`unlink`效果等同于删除文件。

同一文件的多个硬链接，会破坏树状的文件系统。因此，Linux系 统并不鼓励手动创建硬链接。在必要的情况下，你可以用软链接（Soft Link）的方式，在多个目录下创建指向同一文件的链接。

软链接不影响文件的链接数。软链接本质上是一个文件，它的文件 类型是symbolic link。在这个文件中，包含有链接指向的文件的绝对路 径。当读写该文件时，Linux会根据软链接中的绝对路径把读写操作导 向软链接所指向的文件。与Windows系统的"快捷方式"类似，Linux的软 链接就是Linux的"快捷方式"。





# Shell命令行

## 什么是命令行？

#### Shell是UNIX系统提供的文本交互界面

Shell（中文意思是“壳”），是一个应用程序，作用是和用户进行“沟通”。

在CentOS7中，【Ctrl+Alt+F1-F6】可以切换出命令行的窗口，F1是图形化界面。

有了命令名，Shell下一步就要执行该命令名对应的动作。这听起来 就像是在戏剧舞台上，演员按照脚本演戏。Shell命令可以分为如下三类。 

* Shell 内建函数（built-in function）；

* 可执行文件（executable file）；

* 别名（alias）。

Shell的内建函数是保存在Shell内部的脚本。相对应地，可执行文件 是保存在Shell之外的脚本。Shell必须在系统中找到对应命令名的可执行 文件，才能正确执行。别名就是给某个命令起的一个简称，以后在Shell中就可以通过这个 简称来调用对应的命令。在Shell中，我们可以用alias命令来定义别名。

Shell是文本解释器程序的统称，所以包括了不止一种Shell。常见的 Shell有sh、bash、ksh、rsh、csh等。在树莓派中，就安装了sh和bash两 个Shell解释器。

#### 命令行的参数和选项

总的来说， 选项用于控制命令的行为，而参数说明了命令的作用对象。

我们不妨把每个命令看作多功能的瑞士军刀，而选项使命 令可以在不同的功能间切换。

####  如何了解一个陌生的命令

1. 文档
2. 命令——包括`whatis,man（查询可用的命令）,info`
   1. `command --help`获取帮助。
   2. `man command` 查看命令（除了命令，只要是具备手册的东西都能够通过这个命令来查看）的手册，这个手册存放在命令相关的文件中。手册中包含了命令的类型、使用方法。


#### 小窍门

1. 快捷键
   1. 【Tab】命令行补齐、文件名补齐（按一次补全，连续两次能够显示所有的可用命令）
   2. 【Shift+PageUp\PageDown】翻页查看之前的命令行内容
   3. 【Ctrl+C】中断进程
   4. 【Ctrl+D】输入中止，结束符号。`

2. 输出重定向：

​	命令 `> target`命令作用写入到特定的文件

​	命令`>> target`以追加的方式写入

3. 管道：将一个程序的输出作为另一个程序的输入`ls -- help|more`|符号

## 文件操作

Tips：M-时Alt键，^时Ctrl键

- ls（英文全拼：list files）: 列出目录及文件名
- touch   新建文件
- find   命令会递归地遍历文件系统，搜选出符合条件的文件。
- cd（英文全拼：change directory）：切换目录
- pwd（英文全拼：print work directory）：显示目前的目录
- mkdir（英文全拼：make directory）：创建一个新的目录
- rmdir（英文全拼：remove directory）：删除一个空的目录
- cp（英文全拼：copy file）: 复制文件或目录
- rm（英文全拼：remove）: 删除文件或目录
- mv（英文全拼：move file）: 移动文件与目录，或修改文件与目录的名称

## 软件的安装与升级

我们说托瓦兹是"Linux之父"，是因为他编写并维护着Linux最核心 的程序，即Linux内核。除了内核，Linux还需要很多应用程序，比如sh 和bash。Linux内核加上应用程序，就构成了一个Linux发行版本。因 此，就有不同发行版本的Linux，如Debian、Red Hat、Ubuntu、 Raspbian。此外，除了预装的应用程序，用户还需在使用过程中增加新 的应用程序。用户可以直接在网上下载程序的源代码，然后自行编译成 软件。但编译软件需要很多配置，不同软件之间又有依赖关系，所以普 通用户很容易犯错。 

为了解决这个问题，Linux发行版本都有软件分发机制。你可以从 互联网的软件服务器上找到自己需要的软件并下载安装。这些软件服务 器被称为软件源。软件源提供的软件是已经编译好的。如果这些软件依 赖于其他的软件，分发系统也会帮助你自动下载。

`sudo apt-get`+`update/upgrade/install/remove/purge <name>`

下载特别慢的话可以修改为国内的镜像源



# 基础文件编程

Linux中一切皆文件，因此一切都可以修改。

## 编辑器

### Nano-简单好用著称

GNU nano是Shell中常用的一款文本编辑器，它以简单易用著称。 其实，在Shell下，还有更出名、功能更强大的Vi和Emacs编辑器，但这 两款编辑器的学习曲线都比nano陡峭很多。因为nano对于一般的文本编 辑来说已经够用。

### Vim-用途最为广泛

因为有太多 Linux 上面的指令都默认使用 vi 作为数据编辑的接口，所 以你必须、一定要学会 vi ，否则很多指令你根本就无法操作。

* 操作：各种模式——插入/编辑模式、命令模式（默认）

  * a,i,o切换到插入模式；Esc回到命令模式

    * 小i   在光标所在行位置停止不动开始写入内容

      大I   在光标所在行行首开始写入内容

      小a  在光标所在行当前字符后开始写入内容

      大A   在光标所在行行尾开始写入内容

      小o   在光标所在行下一行开始写入内容

      大O  在光标所在行上一行开始写入内容

  * 命令

    * :wq   保存退出

      :wq!  强制保存退出

      :q!    强制退出

      :set nu      显示行号

      :set nonu    不显示行号

      :nohl        不高亮显示

      :x   同样也是保存退出，类似wq 如果在更改文件之后去操作2者的效果完全相同。

  * 编辑模式下：Shift+zz保存退出；u可以撤销 ctl r翻车小；nx删除光标后n个字符；nX删除光标前n个字符；p粘贴



## gcc编译器

1. 一步到位：gcc hello.c 默认生成a.out（-o hello可以生成对应的可执行文件）
   * 运行：./a.out  ./hello
2. 分步处理（预处理（包含库.i）、编译（汇编.s）、汇编（二进制.o）、链接（可执行文件的链接））

## Makefile

make是一个命令，makefile是一个文件，描述了编译规则。

在大量代码的项目的编译中非常方便。



语法规则

* 目标：依赖文件列表

  <Tab>命令列表

* Makefile等文件名可以被make自动寻找；

* makefile 优点在于可以不用全部编译

### makefile变量

类似于脚本，优点是可以直接修改文件名字















