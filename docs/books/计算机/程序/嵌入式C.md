# 嵌入式C语言自我修养

## Chapter1 工欲善其事必先利其器

在Linux环境下，掌握Vim、GCC、make、Git等工具。

1. apt-get是一种Ubuntu中独有的安装包管理工具，能够安装、卸载安装包;update是用来扫描软件源服务器，upgrade是一次性把所有的包更新到最新的版本。

> **sudo apt-get update**
>
> 　　apt-get update命令会扫描每一个软件源服务器，并为该服务器所具有软件包资源建立索引文件，存放在本地的/var/lib/apt/lists/目录中。 使用apt-get执行安装、更新操作时，都将依据这些索引文件，向软件源服务器申请资源。因此，在计算机设备空闲时，经常使用“apt-get update”命令刷新软件源，是一个好的习惯
>
> **sudo apt-get upgrade**
>
> 　　将系统中的所有软件包一次性升级到最新版本，可以很方便的完成在相同版本号的发行版中更新软件包。在依赖关系检查后，命令列出了目前所有需要升级的软件包，在得到用户确认后，便开始更新软件包的下载和安装。当然，apt- get upgrade命令会在最后以合理的次序，安装本次更新的软件包。系统更新需要用户等待一段时间。

2. 换源：参考博客：[ubuntu换镜像源](https://blog.csdn.net/frighting_ing/article/details/122688413)

> **方法一：直接命令行操作文件**
>
> 清华源的使用指南[ubuntu | 镜像站使用帮助 | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror](https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/)
>
> **方法二：图形化界面配置源文件**



### 码编辑工具：Vim

相对于VS、Eclipse这样的集成IDE，Vim最大的特点在于轻量与快捷，并且脱离了鼠标。

1. 安装Vim：apt-get命令，这个命令只在Ubuntu中才能奏效；
2. Vim的操作：已经有经验了，这部分简单过一下就行，其他的内容留在实践中慢慢熟悉吧。
   1. 五个模式：分别是普通、编辑、：进入的命令行模式、v进入的可视化（框选）模式、替换模式（r选中的字符可以直接单个替换）
3. Vim配置：
   1. 先用vim --version寻找配置文件的路径，找到vimrc文件进入配置。
   2. 似乎有很多这个名字的文件，对应的是不同的用户的配置。
   3. 在这个文件中使用set配置文件，这种做法和直接在vim中使用`:set  XX`命令是一样的效果。
      1. 网上可以找到一些好看的插件和Vim工具配置方案，可以直接拉过来使用。
      2. 安装插件的方法就是在/.vim/plugin下防止xx.vim格式的插件复制到这个目录下。然后相关的插件配置就可以在vimrc中使用了。
4. Vim按键的映射：`:map`命令和它的衍生命令可以查找不同模式下的快捷键。在配置文件中也可以在配置文件中进行快捷键的设定。

- 回头网上找一个方法来配置一下vim

### 程序编译工具：make

1. IDE编译C程序的过程是使用了很多的编译器合集，编译过程被IDE软件一步解决了。
2. 安装gcc（C编译工具）。然后就可以正常使用GCC对程序进行编译了。
   1. 如果只需要程序的链接、预处理可以增加命令来实现。
3. 对于大量的c文件，使用make命令一起编译。
   1. make的作用是根据makefile中定义的编译规则把所有符合要求的路径下的C文件集体编译。感觉有点像“自动执行Makefile中的编译命令”的命令。
   2. 命令行开头必须使用Tab（不是空格的Tab）作为开始。
   3. 一般来说就是后两步生成编译的中间文件，第一步整体进行编译，产出结果。目标只是一个名称，这个名称必须与实际上的命令行产出结果一致，编译才能够通过。
   4. Makefile的格式是目标依赖加命令，命令中还是gcc编译器没有改变。直接在Makefile下输入make命令就可以了。

### 代码管理工具：Git

Git是一个版本管理的工具，是不需要联网的，它通过命令行的方式交互，能够管理和记录本地仓库的修改历史。Github则是一个基于Git的在线分布式仓库管理网站，在Git的基础上创造出了分支等一系列的便捷操作。

Git正是Linux的作者Linus开发出的一种分布式代码管理仓库。

需要连接Github则需要生成SSH密钥并在Github上添加。

更加详细的操作细节和玩法可以参考另外一本书《Github入门实践》。



# 计算机体系结构与CPU工作原理

## 从沙砾到芯片

1. Si硅，是晶体管芯片的主要材料，晶体硅的提纯需要从二氧化硅中进行还原，产出多晶硅，然后融化后进行“生长”凝结，获得硅棒形态的单晶硅。贵帮切片生成晶圆，然后设计的模拟和数字电路就会刻印在晶圆上：如今可以达到纳米级别的刻印，当然这需要光刻机。

   1. 芯片进一步被切割、封装、引出管脚，然后进入市场。

2. 芯片的底层原理，实际上就是半导体物理学的范畴，如何用最微观的层面上去实现出所谓的“电容”“电感”“CMOS”等元器件，并通过多层结构压缩在芯片上，这就是芯片设计者所需要考虑的问题。

   1. 半导体的基础还是PN结，Si元素最外层的自由电子和空穴之间形成的P型和N型之分——可以这么认为，PN型半导体虽然没有极性，但是分别表现出了“容易出现空穴/自由电子，因此会从周围夺取/释放电子”的特性——因此二者的组合就发生了自然而然的电子流动，直到生成了一个内建电场抵消了这种“特性”，阻止电流流动的电场和电子扩散的相互平衡，就最终形成了一个稳定PN节。当外部电场削弱内部内建电场时，电子加强扩散行程电流，反过来加强了内建电场则会进一步阻止电流的流动。
   2. MOSFET、三极管也是基于类似的原理设计——电力电子技术、模拟电路中可以看到。
   3. PN节在芯片上的制作最重要的步骤是离子注入和光刻环节。
      1. 光刻（光学曝光），是指利用特定波长的光进行辐照，将掩膜板上的图形转移到光刻胶上的过程。所用的原理和胶片相机类似，掩膜板由透明基板和遮光膜组成。
         1. 电路图需要保存在掩膜版上，然后覆盖在光刻胶（具有感光溶解的特性）上，经过紫外线的照射，就能留下电路图形。
      2. 被溶解掉的部分称为“掺杂窗口”，顾名思义，就是会根据需要对这些窗口中注入不同的离子（相当于是在硅晶的衬底上“造房子”），掺杂三价或五价的元素。
         1. 经过这一步，硅晶的衬底上就能够形成主要由PN节构成的各种元器件。
         2. 每一层都需要重复这一操作，制作对应的掩模版，生成3D迷宫式的立体结构。最后经过一些特殊方法去除光刻胶，留下由金属化的电路。
      3. 真正精密度要求高的其实就是“感光胶片”的形成，如何精确的把电路图投影到光刻胶上就是光刻机的全部工作范围。
         1. 目前世界范围内仅有ASML一家具备光刻机的生产能力。
   4. 芯片的封装：给芯片电路增加一个外壳，引出管脚，让其能够被焊接在电路中。
      1. 封装讲究的是“标准化”，不同的电路要能够节省体积的同时便于电路设计和焊接，就必须按照标准进行引脚的设置和封装。
      2. 测试

   ## CPU是怎么设计出来的

   1. 





