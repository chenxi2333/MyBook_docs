# 物联网

# 图解物联网

物联网的组成从下到上是：设备和传感器、网关、服务器

本质上是互联网+数据收集、分析、处理后获取信息的技术。

## 感测技术

1. RGB-D传感器：传统的彩色三通道之上增加了一个深度的通道，现代常用的测距使用的一般是立体相机（两个摄像头）或者点阵图判断法（红外线投影）
2. 感测技术：卫星定位系统原理——地面的GNSS接收器接收卫星的信号，这个信号中得到的是卫星的时间——通过比对接收器的时间能够知道接收器到卫星的距离，几颗卫星同时对一个接收器进行测量位置可以算出一个人在三维空间中的具体位置。如果在室内，可以通过房屋中的接收器直接返回数据信息——这一部分需要和GNSS的格式统一，人就可以使用GNSS接收器直接获得自身室内位置。

## 物联网服务的系统开发

1. 物联网技术需要形成一个“持续解决问题”的机制，包括预测、创造数据额外的价值。
2. 实际项目中设备开发需要考虑到成本、实际使用场景、需求、精确程度、误差、法律和道德规范等等因素。
3. 系统的后端连接的是数据库，随着数据量的增加，数据库应用的开发也将会成为系统重要的一环。无用的数据可以在设备端进行一定的预处理，再上传服务器，来减轻压力，减少数据传输的冗余。
4. 设备的安全性（物理上的以及数据上都要考虑到），服务器端可以检测数据的流动并主动限制一些可能违规操作的用户（简单来说就是封外挂）。
5. 日志是检测和维修故障的重要部分。设备也可以配备远程管理（远程更新固件），能够节省成本。

## 物联网与数据分析

1. 数据分析从目的上看可以分为这几种：可视化、发现（使用统计或者机器学习的方法提取隐藏信息）、预测。
2. 数据采集+预处理是数据流动的起点；加工分析是结果。不同的数据预处理之后有不同的形式、针对于这些数据也需要采取不同的数据结构进行存储（网络图、图表）。
3. 数据的价值依赖于数学模型去衡量。如何使用合理的模型来挖掘数据的潜力，正式数据分析学科的研究方向——机器学习以及其中的深度学习方法都是一种模型的方法。于此基础上得到的新的东西，可以分为发现特征或者预测规律。
4. CEP技术：复合事件处理技术——用于实时的处理事件中产生的数据；Jubatus：在线学习的数据处理框架
5. 数据的预处理是第一步，去除无效的数据、滤去噪音——完成了这些，数据的处理才能得到有价值的信息。

## 物联网与可穿戴设备

1. 可穿戴设别是新兴的物联网设备之一，它的特点是集成了很多的设备，既是终端，也是传感器——负责的都是与人有关的数据。从持有到穿戴，逐步进化——体积缩小，续航增强，功能完善。
2. 目前来说主流的有——HMD（战术目镜类型）、手表、饰品（主流还是腕带，一般来说比前两个续航能力更强，相对功能不如前者）。
3. 应用场景到医疗到个人的生活娱乐（打VR游戏）工作都有广阔前景。

## 物联网与机器人

1. 机器人本质也是一个智能设备的集合体。它的存在拓展了物联网的可能——数据的价值不仅仅是停留在静态而是“动起来”了，从帮助人工决策成长到直接代替人类（或者由人类直接操控）的部分智能工作——并且能够通过数据做出最明智和正确的选择。
2. 机器人的软件平台既要存放各种传感器与通信硬件的驱动，也需要做出运动的计算并控制电机完成对应操作——ROS为此而生。
3. 接入云端的机器人——功能可以抽象定制，尤其是比如运动控制这一块，可能不再需要每一款机器人都重复开发。



# MQTT

## 简介

MQTT（Message Queuing Telemetry Transport，消息队列遥测传输协议），是一种基于发布/订阅（Publish/Subscribe）模式的轻量级通讯协议，该协议构建于TCP/IP协议上。

MQTT最大的优点在于可以以极少的代码和有限的带宽，为远程设备提供实时可靠的消息服务。做为一种低开销、低带宽占用的即时通讯协议，MQTT在物联网、小型设备、移动应用等方面有广泛的应用。

MQTT协议运行于TCP之上，属于应用层协议，因此只要是支持TCP/IP协议栈的地方，都可以使用MQTT。

> 普通的socket连接对服务器的消耗太大，所以出现了类似MQTT这种轻量级、低消耗的协议来维护长连接。维护长连接需要采用心跳机制，客户端发送一个心跳数据包给服务器，服务器返回给客户端一个心跳应答，从而完成一次客户端-服务器握手，这个握手是让双方都知道他们之间的连接是没有断开的。
>
> 如果超过一个时间阈值，客户端没有收到服务器的心跳应答，或者服务器没有收到客户端的心跳请求，那么表示通信双方连接已经不存在。

## 通讯过程

简单来说：就是订阅（Subscribe）——收报机制

![img](img\MQTT.jpg)



### 消息格式

> 固定报文头 | 可变报文头 | 负荷

MQTT固定报文头最少有两个字节，第一字节包含消息类型（Message Type）和QoS级别等标志位。第二字节开始是剩余长度字段，该长度是后面的可变报文头加消息负载的总长度，该字段最多允许四个字节。

剩余长度字段单个字节最大值为二进制0b0111 1111，16进制0x7F。也就是说，单个字节可以描述的最大长度是127字节。为什么不是256字节呢？因为MQTT协议规定，单个字节第八位（最高位）若为1，则表示后续还有字节存在，第八位起“延续位”的作用。

例如，数字64，编码为一个字节，十进制表示为64，十六进制表示为0×40。数字321（65+2*128）编码为两个字节，重要性最低的放在前面，第一个字节为65+128=193（0xC1），第二个字节是2（0x02），表示2×128。

由于MQTT协议最多只允许使用四个字节表示剩余长度（如表1），并且最后一字节最大值只能是0x7F不能是0xFF，所以能发送的最大消息长度是256MB，而不是512MB。

### 心跳保活机制

连接保活心跳机制（Keep Alive Timer）
MQTT客户端可以设置一个心跳间隔时间（Keep Alive Timer），表示在每个心跳间隔时间内发送一条消息。如果在这个时间周期内，没有业务数据相关的消息，客户端会发一个PINGREQ消息，相应的，服务器会返回一个PINGRESP消息进行确认。如果服务器在一个半（1.5）心跳间隔时间周期内没有收到来自客户端的消息，就会断开与客户端的连接。心跳间隔时间最大值大约可以设置为18个小时，0值意味着客户端不断开。



# 《智能硬件开发与智慧城市建设》

## 智能硬件概述

智能硬件，专指那些具备了人工智能和学习能力的硬件，不仅仅是物联网。联网只是第一步，更加重要的是能够充分发挥联网后的优势。

对于创业者而言，智能硬件的信息安全和一定的技术壁垒是挑战，但是成千上万的现实设别尚未实现智能化，机遇同样存在。

现代的互联网经济以流量模式为主，所谓的“生态变现”无非是养出属于自己的一片鱼塘。目前的产业机会被巨头所垄断，投资者也逐步恢复理智。更何况还有共享经济拿钱跑路的案例，仅仅依靠新概念骗投资再拿钱跑路的这一套对于创业者的生态同样也是危机。

### 目前的行业分析

1. 智能硬件正在启动器——市场开拓，应用创新，人才正在倾斜。
2. 软件上更多的APP正在拓宽思路，从纯软件走向智能硬件的市场。
3. 免费硬件的盈利模式——A点免费，B点盈利。流量变现。
4. 重心偏向制造、同质竞争、跨界合作存在壁垒、核心技术落后、专利争夺

- 未来：数据中滋养出更加成熟的智能。实践和摸索中创造出易用的产品。市场扩大和推动中实现硬件系统性的联动。产品的附加价值被挖掘。
- 市场考量：客户痛点、产品特色、可升级可维护使用低成本？



## 智能硬件理论基础

1. 人工智能的历史
2. 人工智能的八个关键技术方向：
   1. 大数据智能理论：是互联网时代的机器学习和自然语言处理技术，包括了大数据智能基础和大数据智能应用。信息服务的本质是信息采集、传递、储存、计算呈现的全流程效果最优和效果最佳。
   2. 跨媒体感知理论：超越人类自身的限制，去感知世界的方法。——这个领域中存在很多仿生设计。
   3. 混合增强智能理论：引入人类干预的人工智能，人类的认知+机器的感知。脑机。
   4. 群体智能理论：蚁群的智慧——个体智能不高但是群体之间展现出了合作分工的智能行为。分布式的控制，个体的行为简单，个体之间能够通讯，群体展现自组织性智能。
   5. 自主协同控制与优化决策理论：有人系统和无人系统之间的协同工作——协同感知与交互、任务分配等。
   6. 高级机器学习理论：深度学习的本质就是层层分解——把一个抽象复杂的问题分解为简单的，具体的任务。
      1. 相比较于传统的机器学习方法，深度学习：依赖于大量的数据，数据越多效果越好，在少量数据时候不如传统算法，但是数据多了之后性能将会超越传统方法；深度学习对于硬件要求更高；深度学习特征提取由机器完成，人为（专家）干预的更加少了，同时可解释性也将减少。

   7. 类脑智能：仿照人类的大脑设计智能系统。
   8. 量子计算机和人工智能。


## 物联网网关设计

网关作用在于连接——连接的同时更重要的是数据的协议之间的转换。网关是连接传感网和广域网的中介。

> emm有点像现实中的高铁站或者飞机场——本地的设备走路、开车等方法从家里出发（设备到网口间的传输方法或者协议）到达飞机场或者高铁站（网络之间的传输），上传到物联网平台。不同的协议就像不同的交通工具，各有特点，根据应用的场景去选择。

## 物联网应用

医疗、学校、工业、农业、机器人





